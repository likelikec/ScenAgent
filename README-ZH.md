# ScenAgent

[English](README.md) | [ä¸­æ–‡](README-ZH.md)

![Python](https://img.shields.io/badge/Python-3.10%2B-blue?logo=python)
![React](https://img.shields.io/badge/React-18-61DAFB?logo=react)
![FastAPI](https://img.shields.io/badge/FastAPI-0.109-009688?logo=fastapi)
![Platform](https://img.shields.io/badge/Platform-Android-green)

**ScenAgent** æ˜¯æ™ºèƒ½ç§»åŠ¨è®¾å¤‡ä»£ç†æµ‹è¯•æ¡†æ¶ï¼Œæ—¨åœ¨é€šè¿‡å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å’Œå¤šæ¨¡æ€æ„ŸçŸ¥æŠ€æœ¯ï¼Œå®ç°å¯¹ç§»åŠ¨è®¾å¤‡ï¼ˆAndroidï¼‰çš„è‡ªä¸»æ“ä½œä¸ä»»åŠ¡è‡ªåŠ¨åŒ–ã€‚å®ƒé›†æˆäº†å…ˆè¿›çš„å±å¹•æ„ŸçŸ¥ã€å¤šæ™ºèƒ½ä½“ååŒè§„åˆ’ä¸åæ€æœºåˆ¶ï¼Œèƒ½å¤Ÿå¤„ç†å¤æ‚çš„åœºæ™¯ã€‚

---

## ğŸŒŸ æ ¸å¿ƒä»·å€¼ä¸äº®ç‚¹

ScenAgent ä¸ä»…ä»…æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…·å¤‡**è®¤çŸ¥èƒ½åŠ›**çš„æ™ºèƒ½ä½“ç³»ç»Ÿï¼š

*   **è‡ªä¸»è§„åˆ’**: é€šè¿‡ `PlannerAgent` å°†è‡ªç„¶è¯­è¨€æŒ‡ä»¤æ‹†è§£ä¸ºå¯æ‰§è¡Œçš„å­ç›®æ ‡åºåˆ—ï¼Œå¹¶æ ¹æ®ç¯å¢ƒå˜åŒ–åŠ¨æ€è°ƒæ•´ã€‚
*   **ç²¾å‡†æ„ŸçŸ¥**: ç»“åˆ OCRã€UI DOM æ ‘æ¨¡å‹ä¸ VLMï¼Œç²¾å‡†è¯†åˆ«å±å¹•ä¸Šçš„æ–‡æœ¬ä¸å›¾æ ‡ï¼Œæ”¯æŒ VLLM å’Œ SoM (Set-of-Mark) ä¸¤ç§æ„ŸçŸ¥æ¨¡å¼ã€‚
*   **è‡ªæˆ‘åæ€**: ä¼šåœ¨æ¯ä¸€æ­¥æ“ä½œåå¯¹æ¯”å±å¹•å˜åŒ–ï¼Œè¯„ä¼°æ“ä½œæ˜¯å¦æœ‰æ•ˆï¼Œå¹¶å…·å¤‡è·¯å¾„åç¦»æˆ–è€…è·¯å¾„é”™è¯¯çš„çº æ­£èƒ½åŠ›ã€‚
*   **ä¸‰ç§æµ‹è¯•æ¨¡å¼**ï¼šå•APPå•åœºæ™¯ï¼Œå•APPå¤šåœºæ™¯ï¼Œå¤šAPPå¤šåœºæ™¯ã€‚
*   **å¯è§†åŒ–äº¤äº’**: æä¾›ç°ä»£åŒ–çš„ Web ç•Œé¢ï¼Œå®æ—¶ç›‘æ§ Agent çš„æ€è€ƒè¿‡ç¨‹ã€æ“ä½œè½¨è¿¹å’Œå±å¹•çŠ¶æ€ã€‚

---

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- **å¤šæ™ºèƒ½ä½“æ¶æ„**: åŒ…å« Plannerï¼ˆè§„åˆ’ï¼‰ã€Executorï¼ˆæ‰§è¡Œï¼‰ã€Reflectorï¼ˆåæ€ï¼‰ã€TaskJudgeï¼ˆè¯„åˆ¤ï¼‰å››å¤§æ ¸å¿ƒæ™ºèƒ½ä½“ã€‚
- **åŒæ¨¡æ€æ“ä½œ**: æ”¯æŒåŸºäºåæ ‡çš„ç›´æ¥ç‚¹å‡»ï¼ˆVLLMï¼‰å’ŒåŸºäºæ ‡è®°çš„å®šä½æ“ä½œï¼ˆSoMï¼‰ã€‚
- **ä¸‰ç§æµ‹è¯•æ¨¡å¼**ï¼šå•APPå•åœºæ™¯ï¼Œå•APPå¤šåœºæ™¯ï¼Œå¤šAPPå¤šåœºæ™¯ã€‚
- **è®°å¿†æœºåˆ¶**: æ”¯æŒçŸ­æœŸä»»åŠ¡è®°å¿†ä¸é•¿æœŸç»éªŒç§¯ç´¯ï¼ˆTricksï¼‰ã€‚
- **å…¨é¢è¯„ä¼°**: å†…ç½®æŠ¥å‘Šç”Ÿæˆç³»ç»Ÿï¼Œè‡ªåŠ¨äº§å‡ºåŒ…å«æ­¥éª¤è¯¦æƒ…ã€æˆªå›¾å’ŒæˆåŠŸç‡çš„æµ‹è¯•æŠ¥å‘Šã€‚

---

## âœ… ç¯å¢ƒè¦æ±‚

ä¸ºäº†ç¡®ä¿ ScenAgent çš„æ­£å¸¸è¿è¡Œï¼Œè¯·å‡†å¤‡ä»¥ä¸‹åŸºç¡€ç¯å¢ƒï¼š

*   **æ“ä½œç³»ç»Ÿ**: 
    *   æ¨è Windows 10/11, macOS æˆ– Linux (Ubuntu 20.04+)ã€‚
*   **ç¼–ç¨‹è¯­è¨€**: 
    *   **Python**: ç‰ˆæœ¬éœ€ â‰¥ 3.10ï¼Œä»¥æ”¯æŒæœ€æ–°çš„ç±»å‹æ³¨è§£å’Œå¼‚æ­¥ç‰¹æ€§ã€‚
    *   **Node.js**: ç‰ˆæœ¬éœ€ â‰¥ 16.x (ä»…åœ¨å¼€å‘æˆ–æ„å»ºå‰ç«¯ç•Œé¢æ—¶éœ€è¦)ã€‚
*   **è®¾å¤‡è¿æ¥å·¥å…·**:
    *   **Android**: éœ€å®‰è£…å¹¶é…ç½® `adb` (Android Debug Bridge)ï¼Œç¡®ä¿èƒ½å¤Ÿé€šè¿‡å‘½ä»¤è¡Œè¿æ¥è®¾å¤‡ã€‚
*   **ç¡¬ä»¶è¦æ±‚**:
    *   å»ºè®®é…å¤‡ NVIDIA GPU (å¦‚éœ€æœ¬åœ°éƒ¨ç½² VLM/LLM)ï¼Œæˆ–ç¡®ä¿ç½‘ç»œèƒ½å¤Ÿç¨³å®šè®¿é—® OpenAI/Qwen ç­‰åœ¨çº¿ APIã€‚

---

## ğŸ“¥ å®‰è£…æŒ‡å—

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/likelikec/ScenAgent.git
cd ScenAgent
```

### 2. å®‰è£… Python ä¾èµ–

å»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼š

```bash
python -m venv venv
# Windows
.\venv\Scripts\activate
# Linux/macOS
source venv/bin/activate

pip install -r requirements.txt
```

### 3. å®‰è£…å‰ç«¯ä¾èµ– (å¯é€‰)

å¦‚æœæ‚¨éœ€è¦è¿è¡Œ Web ç•Œé¢ï¼š

```bash
cd frontend
npm install
cd ..
```

---

## âš™ é…ç½®è¯´æ˜

é¡¹ç›®æ ¹ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªå…³é”®é…ç½®æ–‡ä»¶ï¼š

### 1. `test.json` (åº”ç”¨ä¸åœºæ™¯å®šä¹‰)
å®šä¹‰äº†æ”¯æŒçš„åº”ç”¨åˆ—è¡¨å’Œå…·ä½“çš„æµ‹è¯•åœºæ™¯ã€‚

```json
{
  "apps": [
    {
      "id": "A1",
      "name": "Taobao",
      "package": "com.taobao.taobao",
      "launch-activity": "com.taobao.tao.welcome.Welcome"
    }
  ],
  "scenarios": [
    {
      "id": "S_SearchProduct",
      "name": "Search for a product",
      "description": "Open Taobao and search for 'iPhone 15'.",
      "extra-info": { "Input Data": "iPhone 15" }
    }
  ]
}
```

### 2. `run-config.json` (è¿è¡Œä»»åŠ¡æµ)
å®šä¹‰äº†ä¸€æ¬¡æ‰¹é‡æ‰§è¡Œçš„ä»»åŠ¡åºåˆ—ã€‚

```json
[
    {
        "app_id": "A1",
        "start_id": "S_SearchProduct",
        "end_id": "S_BuyProduct"
    }
]
```

---

## ğŸ’» è¿è¡Œä¸ä½¿ç”¨

### å‘½ä»¤è¡Œæ¨¡å¼

ç›´æ¥é€šè¿‡ `main.py` å¯åŠ¨ä»»åŠ¡ã€‚

**åŸºæœ¬ç”¨æ³•:**

```bash
python main.py \
  --adb_path "path/to/adb" \
  --api_key "YOUR_LLM_API_KEY" \
  --base_url "YOUR_LLM_BASE_URL" \
  --model "gpt-4o" \
  --scenario_file "test.json" \
  --app_id "A1" \
  --scenario_id "S_SearchProduct"
```

**å‚æ•°è¯¦ç»†è¯´æ˜:**

| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| `--adb_path` | str | None | Android Debug Bridge (ADB) å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚ |  
| `--api_key` | str | Required | LLM æœåŠ¡çš„ API Keyã€‚ |
| `--base_url` | str | Required | LLM æœåŠ¡çš„ Base URLã€‚ |
| `--model` | str | Required | ä½¿ç”¨çš„æ¨¡å‹åç§° (æ¨è `gpt-4o`, `qwen-vl-max` ç­‰å…·å¤‡è§†è§‰èƒ½åŠ›çš„æ¨¡å‹)ã€‚ |
| `--scenario_file` | str | `test.json` | åŒ…å«æµ‹è¯•åœºæ™¯å®šä¹‰çš„ JSON æ–‡ä»¶è·¯å¾„ã€‚ |
| `--app_id` | str | None | ç›®æ ‡åº”ç”¨çš„ ID (éœ€åœ¨ scenario_file ä¸­å®šä¹‰)ã€‚ |
| `--scenario_id` | str | None | æŒ‡å®šè¿è¡Œçš„å•ä¸ªåœºæ™¯ IDã€‚ |
| `--run_config` | str | None | æ‰¹é‡è¿è¡Œé…ç½®æ–‡ä»¶è·¯å¾„ï¼Œç”¨äºä¸€æ¬¡æ€§æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚ |
| `--perception_mode` | str | `vllm` | æ„ŸçŸ¥æ¨¡å¼ï¼š`vllm` (çº¯è§†è§‰æ¨¡å‹ç›´æ¥è¾“å‡ºåæ ‡) æˆ– `som` (åŸºäº Set-of-Mark æ ‡è®°å®šä½)ã€‚ |
| `--output_lang` | str | `zh` | è¾“å‡ºæ—¥å¿—å’ŒæŠ¥å‘Šçš„è¯­è¨€ (`zh` æˆ– `en`)ã€‚ |
| `--planner_tricks` | str | `off` | æ˜¯å¦å¯ç”¨é•¿æœŸè®°å¿†/æŠ€å·§åº“ (`on`/`off`)ï¼Œç”¨äºåŠ é€Ÿå¸¸è§ä»»åŠ¡ã€‚ |

### Web ç•Œé¢æ¨¡å¼

å¯åŠ¨ Web æœåŠ¡ä»¥è·å¾—å¯è§†åŒ–ä½“éªŒã€‚

1.  **å¯åŠ¨åç«¯**:
    ```bash
    python web/server.py
    ```
    æœåŠ¡å°†åœ¨ `http://localhost:8000` å¯åŠ¨ã€‚

2.  **å¯åŠ¨å‰ç«¯** (å¼€å‘æ¨¡å¼):
    ```bash
    cd frontend
    npm run dev
    ```
    è®¿é—® `http://localhost:5173` æ‰“å¼€æ§åˆ¶å°ã€‚

---

## ğŸ“Š å®éªŒç»“æœç¤ºä¾‹

ä»¥ä¸‹æ˜¯ ScenAgent åœ¨çœŸå®åœºæ™¯ä¸­çš„æ‰§è¡Œè®°å½•ã€‚

**ä»»åŠ¡**: Move saved city list (ç§»åŠ¨å·²ä¿å­˜çš„åŸå¸‚åˆ—è¡¨)  
**åº”ç”¨**: Cirrus (å¤©æ°”åº”ç”¨)  
**ç›®æ ‡**: å°† "ä¸Šæµ·" ç§»åŠ¨åˆ°åˆ—è¡¨çš„ç¬¬ä¸€ä½ã€‚

**æ‰§è¡Œæ­¥éª¤æ¦‚è§ˆ**:

1.  **æ‰“å¼€ä¾§è¾¹æ **: è¯†åˆ«å¹¶ç‚¹å‡»å·¦ä¸Šè§’èœå•å›¾æ ‡ã€‚
2.  **è¿›å…¥ç®¡ç†é¡µé¢**: ç‚¹å‡»â€œç®¡ç†ä½ç½®â€é€‰é¡¹ã€‚
3.  **æ‰§è¡Œæ‹–æ‹½/éªŒè¯**: å°è¯•å°†â€œä¸Šæµ·â€å‘ä¸Šæ‹–åŠ¨ã€‚ç³»ç»Ÿæ£€æµ‹åˆ°â€œä¸Šæµ·â€å·²åœ¨ç¬¬ä¸€ä½ï¼Œæ™ºèƒ½åˆ¤å®šä»»åŠ¡å®Œæˆã€‚

**å¯è§†åŒ–è¿‡ç¨‹**:

| æ­¥éª¤ 1: è¯†åˆ«èœå• | æ­¥éª¤ 2: è¯†åˆ«ç®¡ç†å…¥å£ | æ­¥éª¤ 3: æ‹–æ‹½ |æ­¥éª¤ 4: éªŒè¯ |
| :---: | :---: | :---: |:---: |
| ![Step 1](output/T-Cirrus-Move%20saved%20city%20list-20260208_203412/images/screenshot_2026-02-08-74054-2e514262.png) | ![Step 2](output/T-Cirrus-Move%20saved%20city%20list-20260208_203412/images/screenshot_2026-02-08-74097-18bfdf37.png) | ![Step 3](output/T-Cirrus-Move%20saved%20city%20list-20260208_203412/images/screenshot_2026-02-08-74126-b1babe88.png) |![Step 4](output/T-Cirrus-Move%20saved%20city%20list-20260208_203412/images/screenshot_2026-02-08-74165-7ff60880.png) |
| *Action: Click (82, 173)* | *Action: Click (384, 718)* | *Action: Drag (540, 748) -> (540, 468)* |

**æœ€ç»ˆç»“æœ**: 
> ä»»åŠ¡çŠ¶æ€: **Completed**  
> è€—æ—¶: 2åˆ†12ç§’  
> è¯„ä¼°: æˆªå›¾æ˜¾ç¤º 'ä¸Šæµ·' å·²ä½äºåˆ—è¡¨é¡¶éƒ¨ï¼Œä»»åŠ¡ç›®æ ‡è¾¾æˆã€‚

---

## ğŸ¤ å¼€å‘ä¸è´¡çŒ®

æ¬¢è¿æäº¤ Pull Requestï¼

1.  Fork æœ¬ä»“åº“
2.  åˆ›å»ºæ‚¨çš„ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3.  æäº¤æ‚¨çš„æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4.  æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5.  å¼€å¯ä¸€ä¸ª Pull Request

---

